# =============================================================================
# PRODUCTION Override - Project Continuum
# =============================================================================
# Use with: docker compose -f docker-compose.yml -f docker-compose.prod.yml up -d
# Production optimizations: no xdebug, no dev tools, optimized settings
# =============================================================================

services:
  # Production app settings
  app:
    build:
      args:
        UID: 1001
    user: "1001:1001"
    environment:
      - APP_ENV=production
      - APP_DEBUG=false
      - XDEBUG_MODE=off
    restart: always

  # Production nginx
  nginx:
    restart: always

  # Production MySQL
  mysql:
    restart: always
    # Don't expose port externally in production
    ports: []

  # Production Redis
  redis:
    restart: always
    # Don't expose port externally in production
    ports: []

  # Production Queue Worker
  queue:
    build:
      args:
        UID: 1001
    user: "1001:1001"
    restart: always
    command: php artisan queue:work --verbose --tries=3 --timeout=90 --sleep=3 --max-jobs=1000 --max-time=3600

  # Production Reverb
  reverb:
    build:
      args:
        UID: 1001
    user: "1001:1001"
    restart: always

  # Cloudflare Tunnel - enabled by default in production
  cloudflared:
    profiles: []
    restart: always
